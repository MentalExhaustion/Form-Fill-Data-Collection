<!DOCTYPE html>
<html lang="en"><head>
<meta charset="utf-8"/>
<title>Data Collection App</title>
<link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect"/>
<link as="style" href="https://fonts.googleapis.com/css2?display=swap&amp;family=Inter:wght@400;500;700;900&amp;family=Noto+Sans:wght@400;500;700;900" onload="this.rel='stylesheet'" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<style type="text/tailwindcss">
        :root {
            --primary-color: #38e07b;
            --secondary-color: #e6ffe6;
            --background-color: #f8fff8;
            --text-primary: #1a1a1a;
            --text-secondary: #4d4d4d;
            --accent-color: #2cc26a;
        }
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-[var(--background-color)] text-[var(--text-primary)]">
<div class="relative flex size-full min-h-screen flex-col group/design-root overflow-x-hidden">
<div class="layout-container flex h-full grow flex-col">
<header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-gray-200 px-10 py-3 bg-white">
<div class="flex items-center gap-4 text-[var(--text-primary)]">
<div class="size-6 text-[var(--primary-color)]">
<svg fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" stroke-linecap="round" stroke-linejoin="round"></path>
</svg>
</div>
<h2 class="text-lg font-bold leading-tight tracking-[-0.015em]">Data Collection App</h2>
</div>
<div class="flex items-center gap-4">
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDi8SFGGkbJwztSdVmQDxIMEcz6o76GPTFyNHr6Jq6zerGwsmC1T4Q8Pvzqvhd9u5Z3eMrk00SN_5K0ogDjUpx4NJqH5i0SA5FDE-UNvqc6zVDAyUB8K7bA9CVYkRk8X_NLSEcgsYXJ8hhmIWkZlj8Q_ZzQDQGJafcFO2vpA4QbyN9KEVj3R9LpgR5qZHX18FJPL81_jOUtvSC6ANSWAdknWhGAhdbhtfMeJnrw405bpv-1uB-yCTrea6ihhF_uD2NONA3rwSK_PFzZ");'></div>
</div>
</header>
<main class="flex flex-1 items-center justify-center py-5">
<div class="w-full max-w-md">
<div class="bg-white p-8 rounded-xl shadow-lg border border-gray-100 text-center">
<div class="flex justify-center mb-6">
<div class="size-16 bg-[var(--primary-color)] rounded-full flex items-center justify-center">
<svg class="size-10 text-white" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="m4.5 12.75 6 6 9-13.5" stroke-linecap="round" stroke-linejoin="round"></path>
</svg>
</div>
</div>
<h2 class="text-2xl font-bold text-[var(--text-primary)] mb-3">Submission Successful!</h2>
<p class="text-base text-[var(--text-secondary)] leading-relaxed mb-4">
              Your data has been successfully submitted. Thank you for your contribution.
            </p>
            <div id="submission-details" class="bg-gray-50 rounded-lg p-4 mb-6 text-left">
              <h3 class="font-semibold text-[var(--text-primary)] mb-2">Submission Details:</h3>
              <div id="details-content" class="text-sm text-[var(--text-secondary)] space-y-1">
                <!-- Details will be populated by JavaScript -->
              </div>
            </div>
<div class="flex flex-col gap-3">
<button id="go-home-btn" class="bg-[var(--primary-color)] text-white px-8 py-3 rounded-lg font-semibold hover:bg-[var(--accent-color)] focus:outline-none focus:ring-2 focus:ring-[var(--primary-color)] focus:ring-opacity-50 transition-colors duration-200">
<span class="truncate">Submit Another Form</span>
</button>
<button id="logout-btn" class="bg-gray-500 text-white px-8 py-3 rounded-lg font-semibold hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50 transition-colors duration-200">
<span class="truncate">Logout</span>
</button>
</div>
</div>
</div>
</main>
</div>
</div>

<script src="main.js" type="module"></script>
<script type="module">
  document.addEventListener('DOMContentLoaded', async () => {
    // Check if user is logged in
    const userData = localStorage.getItem('userData');
    if (!userData) {
      window.location.href = 'login.html';
      return;
    }

    // Get submission data
    const submissionData = localStorage.getItem('lastSubmissionData');
    const submissionId = localStorage.getItem('lastSubmissionId');

    if (submissionData) {
      const data = JSON.parse(submissionData);
      const detailsContent = document.getElementById('details-content');
      
      detailsContent.innerHTML = `
        <div><strong>Submission ID:</strong> ${submissionId || 'N/A'}</div>
        <div><strong>UC Name:</strong> ${data.ucName}</div>
        <div><strong>UC Number:</strong> ${data.ucNumber}</div>
        <div><strong>LHW Name:</strong> ${data.lhwName}</div>
        <div><strong>Household Name:</strong> ${data.householdName}</div>
        <div><strong>Location:</strong> ${data.location || data.currentLocation}</div>
        <div><strong>Submitted by:</strong> ${data.submittedBy.displayName}</div>
        <div><strong>Submitted at:</strong> ${new Date(data.submittedAt).toLocaleString()}</div>
        ${data.fallbackSubmission ? '<div style="color: orange;"><strong>Status:</strong> Saved locally (will sync when online)</div>' : ''}
      `;
    } else {
      // If no submission data, redirect to form
      window.location.href = 'data_entry_form.html';
    }

    // Event listeners
    document.getElementById('go-home-btn').addEventListener('click', () => {
      // Clear submission data and go to form
      localStorage.removeItem('lastSubmissionData');
      localStorage.removeItem('lastSubmissionId');
      window.location.href = 'data_entry_form.html';
    });

    document.getElementById('logout-btn').addEventListener('click', async () => {
      try {
        // Wait for Firebase to be available
        while (!window.firebaseApp) {
          await new Promise(resolve => setTimeout(resolve, 100));
        }

        const { auth, signOut } = window.firebaseApp;
        
        await signOut(auth);
        localStorage.clear();
        window.location.href = 'login.html';
      } catch (error) {
        console.error('Error signing out:', error);
        // Clear local storage and redirect anyway
        localStorage.clear();
        window.location.href = 'login.html';
      }
    });
  });
</script>
</body></html>