<!DOCTYPE html>
<html lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Data Collector Login</title>
<script src="firebase-config.js" defer type="module"></script>
<link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&amp;display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<style type="text/tailwindcss">
    :root {
      --primary-color: #38e07b;
      --secondary-color: #2cc26a;
      --background-color: #f8fcf9;
      --text-primary: #1a1a1a;
      --text-secondary: #4d4d4d;
      --accent-color: #e6ffe6;
    }
    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--background-color);
      color: var(--text-primary);
    }
  </style>
</head>
<body class="bg-[var(--background-color)]">
<div class="flex items-center justify-center min-h-screen">
<div class="w-full max-w-sm p-8 space-y-8 bg-white rounded-xl shadow-lg border border-gray-200">
<div class="text-center">
<h1 class="text-3xl font-bold text-[var(--text-primary)] mb-2">Welcome Back</h1>
<p class="text-base text-[var(--text-secondary)]">Sign in to continue to Data Collector</p>
</div>
<div class="flex flex-col items-center justify-center">
<button id="google-signin-btn" class="flex items-center justify-center w-full px-4 py-3 mt-4 font-semibold text-white bg-blue-500 rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition duration-200 ease-in-out shadow-md">
<svg class="w-6 h-6 mr-3" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
<path d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z" fill="#FFC107"></path><path d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z" fill="#FF3D00"></path><path d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z" fill="#4CAF50"></path><path d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.574l6.19,5.238C42.021,35.591,44,30.138,44,24C44,22.659,43.862,21.35,43.611,20.083z" fill="#1976D2"></path>
</svg>
<span class="truncate">Sign in with Google</span>
</button>
</div>
</div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
  import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";

  // Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyBUE8FP5aWIYJ4glGmE_H9o17Qpn52Ubhg",
    authDomain: "form-fill-app-d2610.firebaseapp.com",
    projectId: "form-fill-app-d2610",
    storageBucket: "form-fill-app-d2610.firebasestorage.app",
    messagingSenderId: "982130236842",
    appId: "1:982130236842:web:6e5dd3b2d592349bba5fd3",
    measurementId: "G-6XH70HYR26"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const provider = new GoogleAuthProvider();

  // Google Sign-In function
  async function signInWithGoogle() {
    try {
      const result = await signInWithPopup(auth, provider);
      const user = result.user;
      console.log('User signed in:', user.displayName);
      
      // Store user info in localStorage for later use
      localStorage.setItem('userData', JSON.stringify({
        uid: user.uid,
        displayName: user.displayName,
        email: user.email,
        photoURL: user.photoURL
      }));
      
      // Redirect to data entry form
      window.location.href = 'data_entry_form.html';
    } catch (error) {
      console.error('Error during sign-in:', error);
      alert('Sign-in failed: ' + error.message);
    }
  }

  // Check if user is already signed in
  onAuthStateChanged(auth, (user) => {
    if (user) {
      // User is signed in, redirect to data entry form
      console.log('User already signed in:', user.displayName);
      localStorage.setItem('userData', JSON.stringify({
        uid: user.uid,
        displayName: user.displayName,
        email: user.email,
        photoURL: user.photoURL
      }));
      window.location.href = 'data_entry_form.html';
    }
  });

  // Add event listener to Google sign-in button
  document.addEventListener('DOMContentLoaded', () => {
    const signInBtn = document.getElementById('google-signin-btn');
    if (signInBtn) {
      signInBtn.addEventListener('click', signInWithGoogle);
    }
  });
</script>

</body></html>